[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Lorenzo Mattioli",
    "section": "",
    "text": "I am a Master student in Politics and Social Policy at the University of Bologna. My main research interests revolve around social stratification and economic inequality. On this website, you will find a selection of my data analysis projects (both the serious and the unserious) as well as some data literacy teaching material. Check out the about section to get to know me better."
  },
  {
    "objectID": "posts/RxR Report inequality and poverty/index.html",
    "href": "posts/RxR Report inequality and poverty/index.html",
    "title": "Inequality and poverty report",
    "section": "",
    "text": "Show code\npackages &lt;- c('ggbump','tidyverse','laeken','MetBrewer','sf','ggiraph')\ninstall.packages(setdiff(packages, rownames(installed.packages()))) \nrm(packages)\nlibrary(ggbump)\nlibrary(tidyverse)\nlibrary(laeken)\nlibrary(MetBrewer)\nlibrary(sf)\nlibrary(ggiraph)\n# import pdata\npdata &lt;- readRDS('SHIWpdata.rds')\n# Inequality indexes -----------------------------------------------------------\n## Gini - Income ----\n### Over regions by year\nas_tibble(gini(pdata$eqhincome,\n     weights = pdata$peso,\n     years = pdata$anno,\n     breakdown = pdata$ireg,\n     na.rm = T\n)[['valueByStratum']]) -&gt; giniInc\n\nginiInc$stratum &lt;- gsub(' - ', '-', giniInc$stratum)\n### ranking\nginiInc |&gt; \n  group_by(year) |&gt; \n  mutate(\n    rank = rank(value)\n  ) -&gt; giniInc\n### rounding off value\nginiInc$value &lt;- round(giniInc$value, 2)\n\n### ranking5\nginiInc$rank5 &lt;- case_match(giniInc$rank,\n                            1:4 ~ 1,\n                            5:8 ~ 2,\n                            9:12 ~ 3,\n                            13:16 ~ 4,\n                            17:20 ~ 5\n                            )\n### Total by year\nas_tibble_col(gini(pdata$eqhincome,\n     weights = pdata$peso,\n     years = pdata$anno,\n     na.rm = T\n)[[\"value\"]]) -&gt; giniIncTot\n\nginiIncTot$stratum &lt;- 'Italia'\nginiIncTot$year &lt;- c(2000, 2002, 2004, 2008, 2010, 2012, 2014, 2016, 2020)\nginiIncTot$rank &lt;- NA\n\nginiInc &lt;- rbind(giniInc, giniIncTot)\nrm(giniIncTot)\n\n\n## Gini - wealth ----\n### Over regions by year\nas_tibble(gini(pdata$pcwealth,\n               weights = pdata$peso,\n               years = pdata$anno,\n               breakdown = pdata$ireg,\n               na.rm = T\n)[['valueByStratum']]) -&gt; giniW\n\nginiW$stratum &lt;- gsub(' - ', '-', giniW$stratum)\n\n### ranking\nginiW |&gt; \n  group_by(year) |&gt; \n  mutate(\n    rank = rank(value)\n  ) -&gt; giniW\n### ranking5\nginiW$rank5 &lt;- case_match(giniW$rank,\n                            1:4 ~ 1,\n                            5:8 ~ 2,\n                            9:12 ~ 3,\n                            13:16 ~ 4,\n                            17:20 ~ 5\n)\n\n### rounding off value\nginiW$value &lt;- round(giniW$value, 2)\n\n### Total by year\nas_tibble_col(gini(pdata$pcwealth,\n                   weights = pdata$peso,\n                   years = pdata$anno,\n                   na.rm = T\n)[[\"value\"]]) -&gt; giniWTot\n\nginiWTot$stratum &lt;- 'Italia'\nginiWTot$year &lt;- c(2000, 2002, 2004, 2008, 2010, 2012, 2014, 2016, 2020)\nginiWTot$rank &lt;- NA\n\nginiW &lt;- rbind(giniW, giniWTot)\nrm(giniWTot)\n\n\n\n# Poverty  ---------------------------------------------------------------------\n\n## Head count ----\n### Over region by year\npdata |&gt; \n  group_by(anno, ireg) |&gt; \n  count(pov) -&gt; pov\npdata |&gt; \n  group_by(anno, ireg) |&gt; \n  count(!pov) -&gt; pov$'!pov'\npov |&gt; \n  mutate('!pov' = `!pov`$n) |&gt; \n  filter(pov == 1) |&gt; \n  mutate(pov = n) |&gt; \n  select(!n) -&gt; pov\n\npov |&gt; \n  mutate(hCount = pov/(sum(pov, `!pov`))) -&gt; pov\n\n### Ranking\npov |&gt; \n  group_by(anno) |&gt; \n  mutate(\n    rankHCount = 21-rank(hCount)\n  ) -&gt; pov\n\n## Poverty intensity ----\n### povLine\npdata |&gt; \n  group_by(anno) |&gt; \n  summarise(povLine = weightedMedian(eqhincome,\n                                     weights = peso)*0.6) -&gt; povLine\npov &lt;- left_join(pov, povLine)\nrm(povLine)\n\n### Poverty gap\navPoor &lt;- pdata |&gt;\n  filter(pov == 1) |&gt; \n  group_by(anno, ireg) |&gt;\n  summarise(avPoor = weightedMean(eqhincome, weights = peso))\npov &lt;- left_join(pov, avPoor)\nrm(avPoor)\npov$povGapIndex &lt;- pov$hCount * (pov$povLine - pov$avPoor)/pov$povLine\n\n### Ranking\npov |&gt; \n  group_by(anno) |&gt; \n  mutate(\n    rankPovGap = 21-rank(povGapIndex)\n  ) -&gt; pov\n\n## LPM risk of being in poverty ----\npdata &lt;- within(pdata, cfedu &lt;- relevel(factor(cfedu), ref = 'Specializzazione post-laurea'))\npdata &lt;- within(pdata, cfsex &lt;- relevel(factor(cfsex), ref = 'Maschile'))\npdataReg &lt;- pdata |&gt; \n  filter(anno == 2020)\n\n### Regression models\nlpm0 &lt;- lm(pov ~ factor(cfedu),\n   weights = pesopop,\n   data = pdataReg)\nlpm1 &lt;- lm(pov ~ factor(cfedu) + factor(cfsex) + factor(cfclass),\n           weights = pesopop,\n           data = pdataReg)\n\n### Harvesting results\nlpm0results &lt;- as_tibble(summary(lpm0)[[\"coefficients\"]])\nlpm0results &lt;- cbind(lpm0results, confint(lpm0, level=0.95)) #adding CIs\n\nlpm1results &lt;- as_tibble(summary(lpm1)[[\"coefficients\"]])\nlpm1results &lt;- cbind(lpm1results, confint(lpm1, level=0.95)) #adding CIs\nlpm0results &lt;- lpm0results %&gt;% setNames(paste0('0.', names(.)))\n\n### Cleaning results\nlpm0results &lt;- lpm0results |&gt; \n  rownames_to_column(var = 'reg')\nlpm1results &lt;- lpm1results |&gt; \n  rownames_to_column(var = 'reg')\n\nlpmresults &lt;- full_join(lpm0results, lpm1results)\nrm(lpm0results, lpm1results, lpm0, lpm1)\n\nlpmresults['reg'][lpmresults['reg'] == '(Intercept)'] &lt;- ')Intercept'\n\nlpmresults &lt;- lpmresults |&gt; \n  mutate(reg = str_split_fixed(reg, fixed(')'), n = Inf)) \n\nlpmresults &lt;- within(lpmresults, reg &lt;- reg[,2])\n\nlpmresults$'0.star' &lt;- ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.001, '***',\n                            ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.01, '**',\n                                   ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.05, '*',\n                                          ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.1, '.', ''))))\n\nlpmresults$star&lt;- ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.001, '***',\n                              ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.01, '**',\n                                     ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.05, '*',\n                                            ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.1, '.', ''))))\n\nlpmresults &lt;- lpmresults |&gt; \n  relocate('0.star', .before = Estimate)\n\nlpmresults$vars &lt;- c('Intercetta', 'Titolo di studio', 'Titolo di studio', 'Titolo di studio', 'Titolo di studio', 'Titolo di studio', 'Sesso', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale')\n\n\nRxR - una Regione per Restare commissioned a research project on economic inequality in Italy, with a specific focus Umbria, its main region of interest. The complete report is available at forthcoming (in Italian), while the source code is available on github.\nBelow is a selection of the data visualization work involved (translated to English). The project was conducted using R, interactive plots and maps are realised using the ggiraph package."
  },
  {
    "objectID": "posts/RxR Report inequality and poverty/index.html#mapping-inequality-and-poverty",
    "href": "posts/RxR Report inequality and poverty/index.html#mapping-inequality-and-poverty",
    "title": "Inequality and poverty report",
    "section": "Mapping inequality and poverty",
    "text": "Mapping inequality and poverty\n\n\nShow code\n##### import sf\nregMap &lt;- readRDS('regMap.rds')\n\n##### merge Gini tibbles with sf data\nincMap &lt;- left_join(giniInc, regMap, by = join_by(stratum == DEN_REG))\n\n##### ggiraph ready map\nincGiniGG &lt;- incMap |&gt; \n  filter(year == 2000 | year == 2010 |year == 2020) |&gt; \n  drop_na(rank) |&gt; \n  ggplot() +\n  geom_sf_interactive(aes(geometry = geometry, fill = value, data_id = stratum, tooltip = value), colour = 'black') +\n  facet_wrap(vars(year)) +\n  labs(x = NULL, y = NULL,\n       title = 'Gini index by region',\n       subtitle = 'Equivalent household income',\n       caption = 'Data: Bank of Italy. Elaborated by Lorenzo Mattioli - Una Regione per Restare') +\n  theme_minimal(base_family = 'Helvetica') +\n  scale_fill_viridis_c(direction = -1, limits = c(15, 40), option = 'mako') +\n  theme(axis.text.x=element_blank(),\n        axis.ticks.x=element_blank(),\n        axis.text.y=element_blank(),\n        axis.ticks.y=element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank(),\n        plot.title = element_text(size = 20,\n                                  hjust = .5),\n        plot.subtitle = element_text(size = 15,\n                                     hjust = .5),\n        plot.caption = element_text(size = 10,\n                                    hjust = .5))\n\n\n##### interactive map\ngirafe(ggobj = incGiniGG,\n       width_svg = 13,\n       options = list(\n         opts_hover(css = ''), ## CSS code of line we're hovering over\n         opts_hover_inv(css = \"opacity:0.3;\"), ## CSS code of all other lines\n         opts_tooltip(css = \"background-color:white;\n                      color:black;\n                      font-family:Helvetica;\n                      font-style:empty;\n                      padding:8px;\n                      border-radius:10px;\",\n                      use_cursor_pos = T),\n         opts_toolbar(position = 'bottomright')\n       ))\n\n\n\n\n\n\n\n\nShow code\npov$ireg &lt;- gsub(' - ', '-', pov$ireg)\npovMap &lt;- left_join(pov, regMap, by = join_by(ireg == DEN_REG))\n##### ggiraph ready map\npovMap$hCount &lt;- round(povMap$hCount*100, 2)\n\npovhGG &lt;- povMap |&gt; \n  filter(anno == 2000 | anno == 2010 |anno == 2020) |&gt;\n  ggplot() +\n  geom_sf_interactive(aes(geometry = geometry, fill = hCount, data_id = ireg, tooltip = hCount), colour = 'black') +\n  facet_wrap(vars(anno)) +\n  labs(x = NULL, y = NULL,\n       title = 'Poverty headcount by region',\n       caption = 'Data: Bank of Italy. Elaborated by Lorenzo Mattioli - Una Regione per Restare') +\n  theme_minimal(base_family = 'Helvetica') +\n  scale_fill_viridis_c(direction = -1, limits = c(0, 51), option = 'inferno') +\n  theme(axis.text.x=element_blank(),\n        axis.ticks.x=element_blank(),\n        axis.text.y=element_blank(),\n        axis.ticks.y=element_blank(),\n        panel.grid = element_blank(),\n        legend.title = element_blank(),\n        plot.title = element_text(size = 20,\n                                  hjust = .5),\n        plot.subtitle = element_text(size = 15,\n                                     hjust = .5),\n        plot.caption = element_text(size = 10,\n                                    hjust = .5))\n\n\n##### interactive map\ngirafe(ggobj = povhGG,\n       width_svg = 13,\n       options = list(\n         opts_hover(css = ''), ## CSS code of line we're hovering over\n         opts_hover_inv(css = \"opacity:0.3;\"), ## CSS code of all other lines\n         opts_tooltip(css = \"background-color:white;\n                      color:black;\n                      font-family:Helvetica;\n                      font-style:empty;\n                      padding:8px;\n                      border-radius:10px;\",\n                      use_cursor_pos = T),\n         opts_toolbar(position = 'bottomright')\n       ))"
  },
  {
    "objectID": "posts/RxR Report inequality and poverty/index.html#ranking-regions-by-inequality-indexes-and-poverty",
    "href": "posts/RxR Report inequality and poverty/index.html#ranking-regions-by-inequality-indexes-and-poverty",
    "title": "Inequality and poverty report",
    "section": "Ranking regions by inequality indexes and poverty",
    "text": "Ranking regions by inequality indexes and poverty\n\nShow code\n# Gini\nginiInc |&gt; \n  filter(year == 2000 | year == 2004 | year == 2008 | year == 2012 | year == 2016 | year == 2020) |&gt; \n  drop_na(rank) |&gt; \n  ggplot(aes(x = year, y = rank, data_id = stratum)) +\n  geom_bump(linewidth = 0.6, color = 'gray90',\n            data = ~. |&gt; filter(stratum != 'Umbria')) +\n  geom_bump(aes(colour = stratum), linewidth = 0.8,\n            data = ~. |&gt; filter(stratum == 'Umbria' | stratum == 'Lombardia' | stratum == 'Abruzzo')) +\n  geom_point(color = 'gray90',\n             data = ~. |&gt; filter(stratum != 'Umbria'),\n             size = 4) +\n  geom_point(aes(colour = stratum),\n             data = ~. |&gt; filter(stratum == 'Umbria' | stratum == 'Lombardia' | stratum == 'Abruzzo'),\n             size = 4) +\n  geom_point(color = 'white', size = 2) +\n  geom_text_interactive(aes(label = stratum, group = stratum), colour = 'gray90', x = 2021, hjust = 0, size = 3.5, family = 'Helvetica',\n                        data = ~. |&gt; filter(year == 2020)) +\n  geom_text(aes(label = stratum, group = stratum), colour = 'black', x = 2021, hjust = 0,, size = 3.5, family = 'Helvetica',\n            data = ~. |&gt; filter(year == 2020 & stratum == 'Umbria' | year == 2020 & stratum == 'Lombardia' | year == 2020 & stratum == 'Abruzzo')) +\n  scale_color_viridis_d(option = 'mako', end = .6) +\n  scale_x_continuous(limits = c(2000, 2024) ,expand = c(0.01, 0), breaks=c(2000, 2004, 2008, 2012, 2016, 2020)) +\n  scale_y_reverse(expand = c(0.02, 0), breaks = c(5, 10, 15, 20)) +\n  labs(x = NULL, y = NULL,\n       title = 'Ranking Italian regions by Gini index',\n       subtitle = 'Equivalent household income',\n       caption = 'Data: Bank of Italy. Elaborated by Lorenzo Mattioli - Una Regione per Restare') +\n  theme_minimal(base_family = 'Helvetica') +\n  theme(\n    legend.position = 'none',\n    panel.grid = element_blank(),\n    plot.title = element_text(size = 20,\n                              hjust = .5),\n    plot.subtitle = element_text(size = 15,\n                                 hjust = .5),\n    plot.caption = element_text(size = 10,\n                                hjust = .5)\n  )\n# Poverty\npov |&gt; \n  filter(anno == 2000 | anno == 2004 | anno == 2008 | anno == 2012 | anno == 2016 | anno == 2020) |&gt; \n  ggplot(aes(x = anno, y = rankHCount, group = ireg, data_id = ireg)) +\n    geom_bump(linewidth = 0.6, color = \"gray90\", smooth = 6) +\n    geom_bump(aes(colour = ireg), linewidth = 0.8, smooth = 6,\n                data = ~. |&gt; filter(ireg == 'Umbria' | ireg == 'Lombardia' | ireg == 'Abruzzo')) +\n    geom_point(color = \"gray90\", size = 4) +\n    geom_point(aes(colour = ireg),\n               data = ~. |&gt; filter(ireg == 'Umbria' | ireg == 'Lombardia' | ireg == 'Abruzzo'),\n               size = 4) +\n    geom_point(color = 'white', size = 2) +\n    geom_text(aes(label = ireg, group = ireg), colour = 'gray90', x = 2021, hjust = 0, size = 3.5, family = 'Helvetica',\n              data = ~. |&gt; filter(anno == 2020)) +\n    geom_text(aes(label = ireg, group = ireg), colour = 'black', x = 2021, hjust = 0,, size = 3.5, family = 'Helvetica',\n              data = ~. |&gt; filter(anno == 2020 & ireg == 'Umbria' | anno == 2020 & ireg == 'Lombardia' | anno == 2020 & ireg == 'Abruzzo')) +\n    scale_color_manual(values = met.brewer('Degas')) +\n    scale_x_continuous(limits = c(2000, 2024) ,expand = c(0.01, 0), breaks=c(2000, 2010, 2020)) +\n    scale_y_reverse(expand = c(0.02, 0), breaks = c(1, 5, 10, 15, 20)) +\n    labs(x = NULL, y = NULL,\n         title = 'Ranking Italian regions by poverty rate',\n         subtitle = 'Headcount, from poorest to least poor',\n         caption = 'Data: Bank of Italy. Elaborated by Lorenzo Mattioli - Una Regione per Restare') +\n    theme_minimal(base_family = 'Helvetica') +\n    theme(\n      legend.position = 'none',\n      panel.grid = element_blank(),\n      plot.title = element_text(size = 20,\n                           hjust = .5),\n      plot.subtitle = element_text(size = 15,\n                                   hjust = .5),\n      plot.caption = element_text(size = 10,\n                                  hjust = .5)\n    )"
  },
  {
    "objectID": "posts/RxR Report inequality and poverty/index.html#investigating-causes-of-poverty-through-lpm-modeling",
    "href": "posts/RxR Report inequality and poverty/index.html#investigating-causes-of-poverty-through-lpm-modeling",
    "title": "Inequality and poverty report",
    "section": "Investigating causes of poverty through LPM modeling",
    "text": "Investigating causes of poverty through LPM modeling\n\n\nShow code\nlpmresults$vars &lt;- factor(lpmresults$vars, levels=unique(lpmresults$vars))\nlpmresults$roundEst &lt;- round(lpmresults$Estimate, 2)\n\ngglpm &lt;- lpmresults |&gt; \n  filter(vars == 'Titolo di studio') |&gt; \n  ggplot(aes(x=Estimate, y=reg, colour = vars, data_id = roundEst, tooltip = roundEst)) +\n  geom_vline(xintercept = 0,\n             linewidth = 0.4,\n             color = 'gray70') +\n  geom_linerange_interactive(aes(xmin=`2.5 %`,xmax=`97.5 %`), linewidth = .6) +\n  geom_point_interactive(size = 6) +\n  geom_point(colour = 'white', size = 3) +\n  geom_point_interactive(aes(x = `2.5 %`), shape = '|', size = 6) +\n  geom_point_interactive(aes(x = `97.5 %`), shape = '|', size = 6) +\n  labs(x = NULL, y = NULL,\n       title = 'Probability of relative poverrty based on head of household\\'s educational attainment',\n       subtitle = 'Reference category: post-lauream specialisation',\n       caption = 'Data: Bank of Italy. Elaborated by Lorenzo Mattioli - Una Regione per Restare') +\n  scale_color_manual(values = met.brewer('Degas')) +\n  theme_minimal(base_family = 'Helvetica') +\n  theme(panel.grid = element_line(),\n        legend.position = 'none',\n        axis.text = element_text(size = 13),\n        plot.title = element_text(size = 20,\n                                  hjust = 0),\n        plot.subtitle = element_text(size = 15,\n                                     hjust = 0),\n        plot.caption = element_text(size = 10,\n                                    hjust = .5))\n\ngirafe(ggobj = gglpm,\n       width_svg = 13,\n       options = list(\n         opts_hover(css = ''), ## CSS code of line we're hovering over\n         opts_hover_inv(css = \"opacity:0.3;\"), ## CSS code of all other lines\n         opts_tooltip(css = \"background-color:white;\n                      color:black;\n                      font-family:Helvetica;\n                      font-style:empty;\n                      padding:8px;\n                      border-radius:10px;\",\n                      use_cursor_pos = T),\n         opts_toolbar(position = 'bottomright')))"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Lorenzo Mattioli",
    "section": "",
    "text": "I have a background in Economics, and am now a Master student in Politics and Social Policy at the University of Bologna. In addition to my research activities at university, I am also involved with the association una Regione per Restare (RxR) as head of their Social Observatory.\nDue to my mixed background, I can count on solid foundations in data analysis and econometrics, as well as on extensive domain knowledge in social sciences.\nMy main research interests revolve around social stratification and material inequality, but the Projects section of this site will also accommodate some of my less “serious” work, as well as some teaching material.\n\nMy complete resume is available here:"
  },
  {
    "objectID": "posts/RxR Report inequality and poverty/index.html#introduction",
    "href": "posts/RxR Report inequality and poverty/index.html#introduction",
    "title": "Inequality and poverty report",
    "section": "",
    "text": "Show code\npackages &lt;- c('ggbump','tidyverse','laeken','MetBrewer','sf','ggiraph')\ninstall.packages(setdiff(packages, rownames(installed.packages()))) \nrm(packages)\nlibrary(ggbump)\nlibrary(tidyverse)\nlibrary(laeken)\nlibrary(MetBrewer)\nlibrary(sf)\nlibrary(ggiraph)\n# import pdata\npdata &lt;- readRDS('SHIWpdata.rds')\n# Inequality indexes -----------------------------------------------------------\n## Gini - Income ----\n### Over regions by year\nas_tibble(gini(pdata$eqhincome,\n     weights = pdata$peso,\n     years = pdata$anno,\n     breakdown = pdata$ireg,\n     na.rm = T\n)[['valueByStratum']]) -&gt; giniInc\n\nginiInc$stratum &lt;- gsub(' - ', '-', giniInc$stratum)\n### ranking\nginiInc |&gt; \n  group_by(year) |&gt; \n  mutate(\n    rank = rank(value)\n  ) -&gt; giniInc\n### rounding off value\nginiInc$value &lt;- round(giniInc$value, 2)\n\n### ranking5\nginiInc$rank5 &lt;- case_match(giniInc$rank,\n                            1:4 ~ 1,\n                            5:8 ~ 2,\n                            9:12 ~ 3,\n                            13:16 ~ 4,\n                            17:20 ~ 5\n                            )\n### Total by year\nas_tibble_col(gini(pdata$eqhincome,\n     weights = pdata$peso,\n     years = pdata$anno,\n     na.rm = T\n)[[\"value\"]]) -&gt; giniIncTot\n\nginiIncTot$stratum &lt;- 'Italia'\nginiIncTot$year &lt;- c(2000, 2002, 2004, 2008, 2010, 2012, 2014, 2016, 2020)\nginiIncTot$rank &lt;- NA\n\nginiInc &lt;- rbind(giniInc, giniIncTot)\nrm(giniIncTot)\n\n\n## Gini - wealth ----\n### Over regions by year\nas_tibble(gini(pdata$pcwealth,\n               weights = pdata$peso,\n               years = pdata$anno,\n               breakdown = pdata$ireg,\n               na.rm = T\n)[['valueByStratum']]) -&gt; giniW\n\nginiW$stratum &lt;- gsub(' - ', '-', giniW$stratum)\n\n### ranking\nginiW |&gt; \n  group_by(year) |&gt; \n  mutate(\n    rank = rank(value)\n  ) -&gt; giniW\n### ranking5\nginiW$rank5 &lt;- case_match(giniW$rank,\n                            1:4 ~ 1,\n                            5:8 ~ 2,\n                            9:12 ~ 3,\n                            13:16 ~ 4,\n                            17:20 ~ 5\n)\n\n### rounding off value\nginiW$value &lt;- round(giniW$value, 2)\n\n### Total by year\nas_tibble_col(gini(pdata$pcwealth,\n                   weights = pdata$peso,\n                   years = pdata$anno,\n                   na.rm = T\n)[[\"value\"]]) -&gt; giniWTot\n\nginiWTot$stratum &lt;- 'Italia'\nginiWTot$year &lt;- c(2000, 2002, 2004, 2008, 2010, 2012, 2014, 2016, 2020)\nginiWTot$rank &lt;- NA\n\nginiW &lt;- rbind(giniW, giniWTot)\nrm(giniWTot)\n\n\n\n# Poverty  ---------------------------------------------------------------------\n\n## Head count ----\n### Over region by year\npdata |&gt; \n  group_by(anno, ireg) |&gt; \n  count(pov) -&gt; pov\npdata |&gt; \n  group_by(anno, ireg) |&gt; \n  count(!pov) -&gt; pov$'!pov'\npov |&gt; \n  mutate('!pov' = `!pov`$n) |&gt; \n  filter(pov == 1) |&gt; \n  mutate(pov = n) |&gt; \n  select(!n) -&gt; pov\n\npov |&gt; \n  mutate(hCount = pov/(sum(pov, `!pov`))) -&gt; pov\n\n### Ranking\npov |&gt; \n  group_by(anno) |&gt; \n  mutate(\n    rankHCount = 21-rank(hCount)\n  ) -&gt; pov\n\n## Poverty intensity ----\n### povLine\npdata |&gt; \n  group_by(anno) |&gt; \n  summarise(povLine = weightedMedian(eqhincome,\n                                     weights = peso)*0.6) -&gt; povLine\npov &lt;- left_join(pov, povLine)\nrm(povLine)\n\n### Poverty gap\navPoor &lt;- pdata |&gt;\n  filter(pov == 1) |&gt; \n  group_by(anno, ireg) |&gt;\n  summarise(avPoor = weightedMean(eqhincome, weights = peso))\npov &lt;- left_join(pov, avPoor)\nrm(avPoor)\npov$povGapIndex &lt;- pov$hCount * (pov$povLine - pov$avPoor)/pov$povLine\n\n### Ranking\npov |&gt; \n  group_by(anno) |&gt; \n  mutate(\n    rankPovGap = 21-rank(povGapIndex)\n  ) -&gt; pov\n\n## LPM risk of being in poverty ----\npdata &lt;- within(pdata, cfedu &lt;- relevel(factor(cfedu), ref = 'Specializzazione post-laurea'))\npdata &lt;- within(pdata, cfsex &lt;- relevel(factor(cfsex), ref = 'Maschile'))\npdataReg &lt;- pdata |&gt; \n  filter(anno == 2020)\n\n### Regression models\nlpm0 &lt;- lm(pov ~ factor(cfedu),\n   weights = pesopop,\n   data = pdataReg)\nlpm1 &lt;- lm(pov ~ factor(cfedu) + factor(cfsex) + factor(cfclass),\n           weights = pesopop,\n           data = pdataReg)\n\n### Harvesting results\nlpm0results &lt;- as_tibble(summary(lpm0)[[\"coefficients\"]])\nlpm0results &lt;- cbind(lpm0results, confint(lpm0, level=0.95)) #adding CIs\n\nlpm1results &lt;- as_tibble(summary(lpm1)[[\"coefficients\"]])\nlpm1results &lt;- cbind(lpm1results, confint(lpm1, level=0.95)) #adding CIs\nlpm0results &lt;- lpm0results %&gt;% setNames(paste0('0.', names(.)))\n\n### Cleaning results\nlpm0results &lt;- lpm0results |&gt; \n  rownames_to_column(var = 'reg')\nlpm1results &lt;- lpm1results |&gt; \n  rownames_to_column(var = 'reg')\n\nlpmresults &lt;- full_join(lpm0results, lpm1results)\nrm(lpm0results, lpm1results, lpm0, lpm1)\n\nlpmresults['reg'][lpmresults['reg'] == '(Intercept)'] &lt;- ')Intercept'\n\nlpmresults &lt;- lpmresults |&gt; \n  mutate(reg = str_split_fixed(reg, fixed(')'), n = Inf)) \n\nlpmresults &lt;- within(lpmresults, reg &lt;- reg[,2])\n\nlpmresults$'0.star' &lt;- ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.001, '***',\n                            ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.01, '**',\n                                   ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.05, '*',\n                                          ifelse(lpmresults$`0.Pr(&gt;|t|)` &lt;= 0.1, '.', ''))))\n\nlpmresults$star&lt;- ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.001, '***',\n                              ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.01, '**',\n                                     ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.05, '*',\n                                            ifelse(lpmresults$`Pr(&gt;|t|)` &lt;= 0.1, '.', ''))))\n\nlpmresults &lt;- lpmresults |&gt; \n  relocate('0.star', .before = Estimate)\n\nlpmresults$vars &lt;- c('Intercetta', 'Titolo di studio', 'Titolo di studio', 'Titolo di studio', 'Titolo di studio', 'Titolo di studio', 'Sesso', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale', 'Settore economico dell\\'occupazione principale')\n\n\nRxR - una Regione per Restare commissioned a research project on economic inequality in Italy, with a specific focus Umbria, its main region of interest. The complete report is available at forthcoming (in Italian), while the source code is available on github.\nBelow is a selection of the data visualization work involved (translated to English). The project was conducted using R, interactive plots and maps are realised using the ggiraph package."
  },
  {
    "objectID": "projects.html",
    "href": "projects.html",
    "title": "Lorenzo Mattioli",
    "section": "",
    "text": "I am a Master student in Politics and Social Policy at the University of Bologna. My main research interests revolve around social stratification and economic inequality. On this website, you will find a selection of my data analysis projects (both the serious and the unserious) as well as some data literacy teaching material. Check out the about section to get to know me better.\n\n\n\n\n\n\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Title\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\nInequality and poverty report\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#recent-projects",
    "href": "index.html#recent-projects",
    "title": "Lorenzo Mattioli",
    "section": "Recent projects",
    "text": "Recent projects"
  }
]